---
sidebar: sidebar 
permalink: concept-ha.html 
keywords: high availability, HA, mediator, concepts, understanding, overview, availability zones, AZs, takeover, giveback, rpo, rto, floating ip, nondisruptive, ha pairs, node, nodes, synchronous, resync, recovery point objective, recovery time objective, nas, nfs, cifs, floating ip address, route tables, iscsi, mpio, alua, failover, mount, remount, failure, data access, access, ip address, performance 
summary: 'Cloud Volumes ONTAP 고가용성(HA) 구성은 중단 없는 운영과 내결함성을 제공합니다.  AWS에서는 데이터가 두 노드 간에 동기적으로 미러링됩니다.' 
---
= AWS의 Cloud Volumes ONTAP HA 쌍에 대해 알아보세요
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Cloud Volumes ONTAP 고가용성(HA) 구성은 중단 없는 운영과 내결함성을 제공합니다.  AWS에서는 데이터가 두 노드 간에 동기적으로 미러링됩니다.



== HA 구성 요소

AWS에서 Cloud Volumes ONTAP HA 구성에는 다음 구성 요소가 포함됩니다.

* 두 개의 Cloud Volumes ONTAP 노드의 데이터가 서로 동기적으로 미러링됩니다.
* 저장소 인수 및 반환 프로세스를 지원하기 위해 노드 간 통신 채널을 제공하는 중재자 인스턴스입니다.




=== 중재인

AWS의 중재자 인스턴스에 대한 몇 가지 주요 세부 정보는 다음과 같습니다.

인스턴스 유형:: t3-마이크로
디스크:: 8GiB와 4GiB의 두 개의 st1 디스크
운영 체제:: 데비안 11
+
--

NOTE: Cloud Volumes ONTAP 9.10.0 및 이전 버전의 경우, Debian 10이 메디에이터에 설치되었습니다.

--
업그레이드:: Cloud Volumes ONTAP 업그레이드하면 NetApp 콘솔도 필요에 따라 중재자 인스턴스를 업데이트합니다.
인스턴스에 대한 액세스:: 콘솔에서 Cloud Volumes ONTAP HA 쌍을 생성하면 중재자 인스턴스에 대한 키 쌍을 제공하라는 메시지가 표시됩니다.  SSH 액세스를 위해 해당 키 쌍을 사용할 수 있습니다. `admin` 사용자.
제3자 에이전트:: 중재자 인스턴스에서는 타사 에이전트나 VM 확장이 지원되지 않습니다.




== 저장소 인수 및 반환

노드 하나가 다운되더라도 다른 노드는 파트너에게 데이터를 제공하여 지속적인 데이터 서비스를 제공할 수 있습니다.  데이터가 파트너에 동기적으로 미러링되었기 때문에 클라이언트는 파트너 노드에서 동일한 데이터에 액세스할 수 있습니다.

노드가 재부팅된 후 파트너는 저장소를 반환하기 전에 데이터를 다시 동기화해야 합니다.  데이터를 다시 동기화하는 데 걸리는 시간은 노드가 다운된 동안 얼마나 많은 데이터가 변경되었는지에 따라 달라집니다.

저장소 인수, 재동기화 및 반환은 모두 기본적으로 자동으로 수행됩니다. 사용자 작업이 필요하지 않습니다.



== RPO와 RTO

HA 구성은 다음과 같이 데이터의 고가용성을 유지합니다.

* 복구 지점 목표(RPO)는 0초입니다.  귀하의 데이터는 데이터 손실 없이 거래적으로 일관성을 유지합니다.
* 복구 시간 목표(RTO)는 120초입니다.  정전이 발생하더라도 120초 이내에 데이터를 사용할 수 있어야 합니다.




== HA 배포 모델

여러 가용성 영역(AZ) 또는 단일 가용성 영역(AZ)에 HA 구성을 배포하여 데이터의 높은 가용성을 보장할 수 있습니다.  각 구성에 대한 자세한 내용을 검토하여 귀하의 요구 사항에 가장 적합한 구성을 선택하시기 바랍니다.



=== 여러 가용성 영역

여러 가용성 영역(AZ)에 HA 구성을 배포하면 Cloud Volumes ONTAP 노드를 실행하는 AZ 또는 인스턴스에 장애가 발생하더라도 데이터의 고가용성이 보장됩니다.  NAS IP 주소가 데이터 액세스와 스토리지 장애 조치에 어떤 영향을 미치는지 이해해야 합니다.



==== NFS 및 CIFS 데이터 액세스

HA 구성이 여러 가용성 영역에 걸쳐 분산되어 있는 경우 _유동 IP 주소_를 사용하면 NAS 클라이언트 액세스가 가능합니다.  해당 지역의 모든 VPC에 대한 CIDR 블록 외부에 있어야 하는 유동 IP 주소는 장애가 발생하면 노드 간에 마이그레이션될 수 있습니다.  VPC 외부에 있는 클라이언트는 기본적으로 액세스할 수 없습니다.link:task-setting-up-transit-gateway.html["AWS 전송 게이트웨이 설정"] .

트랜짓 게이트웨이를 설정할 수 없는 경우 VPC 외부에 있는 NAS 클라이언트에서 개인 IP 주소를 사용할 수 있습니다.  하지만 이러한 IP 주소는 정적이므로 노드 간에 장애 조치를 취할 수 없습니다.

여러 가용성 영역에 HA 구성을 배포하기 전에 부동 IP 주소와 경로 테이블에 대한 요구 사항을 검토해야 합니다.  구성을 배포할 때 부동 IP 주소를 지정해야 합니다.  개인 IP 주소는 자동으로 생성됩니다.

자세한 내용은 다음을 참조하세요. link:https://docs.netapp.com/us-en/bluexp-cloud-volumes-ontap/reference-networking-aws.html#requirements-for-ha-pairs-in-multiple-azs["여러 AZ에서 Cloud Volumes ONTAP HA에 대한 AWS 네트워킹 요구 사항"^] .



==== iSCSI 데이터 액세스

iSCSI는 유동 IP 주소를 사용하지 않으므로 VPC 간 데이터 통신은 문제가 되지 않습니다.



==== iSCSI 인수 및 환원

iSCSI의 경우 Cloud Volumes ONTAP 다중 경로 I/O(MPIO) 및 비대칭 논리 단위 액세스(ALUA)를 사용하여 활성 최적화 경로와 최적화되지 않은 경로 간의 경로 장애 조치를 관리합니다.


NOTE: ALUA를 지원하는 특정 호스트 구성에 대한 정보는 다음을 참조하십시오. http://mysupport.netapp.com/matrix["NetApp 상호 운용성 매트릭스 도구"^] 그리고 https://docs.netapp.com/us-en/ontap-sanhost/["SAN 호스트 및 클라우드 클라이언트 가이드"] 호스트 운영 체제에 맞게.



==== NAS 인수 및 환원

유동 IP를 사용하는 NAS 구성에서 인수가 발생하면 클라이언트가 데이터에 액세스하는 데 사용하는 노드의 유동 IP 주소가 다른 노드로 이동합니다.  다음 이미지는 플로팅 IP를 사용한 NAS 구성에서의 스토리지 인수를 보여줍니다.  노드 2가 다운되면 노드 2의 플로팅 IP 주소가 노드 1로 이동합니다.

image:diagram_takeover_giveback.png["Cloud Volumes ONTAP HA 쌍에서 스토리지 인수를 보여주는 개념적 이미지: 노드 1의 플로팅 IP 주소가 노드 2로 이동합니다."]

장애가 발생하면 외부 VPC 액세스에 사용되는 NAS 데이터 IP는 노드 간에 마이그레이션할 수 없습니다.  노드가 오프라인 상태가 되면 다른 노드의 IP 주소를 사용하여 VPC 외부의 클라이언트에 볼륨을 수동으로 다시 마운트해야 합니다.

실패한 노드가 다시 온라인 상태가 되면 원래 IP 주소를 사용하여 클라이언트를 볼륨에 다시 마운트합니다.  이 단계는 두 HA 노드 간에 불필요한 데이터 전송을 방지하기 위해 필요합니다. 불필요한 데이터 전송은 성능과 안정성에 상당한 영향을 미칠 수 있습니다.

볼륨을 선택하고 *마운트 명령*을 클릭하면 콘솔에서 올바른 IP 주소를 찾을 수 있습니다.



=== 단일 가용성 영역

단일 가용성 영역(AZ)에 HA 구성을 배포하면 Cloud Volumes ONTAP 노드를 실행하는 인스턴스에 장애가 발생하더라도 데이터의 고가용성을 보장할 수 있습니다.  모든 데이터는 기본적으로 VPC 외부에서 접근할 수 있습니다.


NOTE: 콘솔은 다음을 생성합니다. https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/placement-groups.html["AWS 문서: AWS 스프레드 배치 그룹"^] 그리고 해당 배치 그룹에서 두 개의 HA 노드를 시작합니다. 배치 그룹은 인스턴스를 여러 기본 하드웨어에 분산하여 동시 장애가 발생할 위험을 줄입니다. 이 기능은 디스크 오류 관점이 아닌 컴퓨팅 관점에서 중복성을 향상시킵니다.



==== 데이터 접근

이 구성은 단일 AZ에 있으므로 유동 IP 주소가 필요하지 않습니다.  VPC 내부와 외부에서 데이터에 액세스하는 데 동일한 IP 주소를 사용할 수 있습니다.

다음 이미지는 단일 AZ의 HA 구성을 보여줍니다.  VPC 내부와 외부에서 데이터에 접근할 수 있습니다.

image:diagram_single_az.png["VPC 외부에서 데이터 액세스를 허용하는 단일 가용성 영역에서 ONTAP HA 구성을 보여주는 개념적 이미지입니다."]



==== 인수와 환원

iSCSI의 경우 Cloud Volumes ONTAP 다중 경로 I/O(MPIO) 및 비대칭 논리 단위 액세스(ALUA)를 사용하여 활성 최적화 경로와 최적화되지 않은 경로 간의 경로 장애 조치를 관리합니다.


NOTE: ALUA를 지원하는 특정 호스트 구성에 대한 정보는 다음을 참조하십시오. http://mysupport.netapp.com/matrix["NetApp 상호 운용성 매트릭스 도구"^] 그리고 https://docs.netapp.com/us-en/ontap-sanhost/["SAN 호스트 및 클라우드 클라이언트 가이드"] 호스트 운영 체제에 맞게.

NAS 구성의 경우 장애가 발생하면 데이터 IP 주소가 HA 노드 간에 마이그레이션될 수 있습니다.  이를 통해 클라이언트가 저장소에 액세스할 수 있습니다.



=== AWS 로컬 영역

AWS 로컬 존은 스토리지, 컴퓨팅, 데이터베이스 및 기타 선택된 AWS 서비스가 대도시와 산업 지역 근처에 위치하는 인프라 배포입니다.  AWS 로컬 존을 사용하면 AWS 서비스를 사용자에게 더 가깝게 제공하여 워크로드의 지연 시간을 개선하고 데이터베이스를 로컬로 유지 관리할 수 있습니다.  Cloud Volumes ONTAP 에서

AWS 로컬 영역에는 단일 AZ 또는 여러 AZ 구성을 배포할 수 있습니다.


NOTE: AWS 로컬 영역은 표준 모드와 프라이빗 모드에서 콘솔을 사용할 때 지원됩니다.  현재 AWS 로컬 영역은 제한 모드에서 지원되지 않습니다.



==== AWS 로컬 영역 구성 예

AWS의 Cloud Volumes ONTAP 단일 가용성 영역에서만 고가용성(HA) 모드를 지원합니다.  단일 노드 배포는 지원되지 않습니다.

Cloud Volumes ONTAP AWS 로컬 영역에서 데이터 계층화, 클라우드 계층화 및 비적격 인스턴스를 지원하지 않습니다.

다음은 구성의 예입니다.

* 단일 가용성 영역: 클러스터 노드와 중재자가 모두 동일한 로컬 영역에 있습니다.
* 여러 가용성 영역 여러 가용성 영역 구성에는 인스턴스 3개, 노드 2개, 중재자 1개가 있습니다.  세 개의 인스턴스 중 하나는 별도의 영역에 있어야 합니다.  설정 방법은 사용자가 선택할 수 있습니다.
+
다음은 세 가지 구성 예입니다.

+
** 각 클러스터 노드는 다른 로컬 영역에 있고 중재자는 공용 가용성 영역에 있습니다.
** 로컬 영역에 있는 한 클러스터 노드, 로컬 영역에 있는 중재자, 그리고 가용성 영역에 있는 두 번째 클러스터 노드.
** 각 클러스터 노드와 중재자는 별도의 로컬 영역에 있습니다.






==== 지원되는 디스크 및 인스턴스 유형

지원되는 디스크 유형은 GP2뿐입니다.  현재 지원되는 EC2 인스턴스 유형 패밀리는 xlarge에서 4xlarge까지입니다.

* M5
* C5
* C5d
* R5
* R5d



NOTE: Cloud Volumes ONTAP 이러한 구성만 지원합니다.  AWS 로컬 영역 구성에서 지원되지 않는 디스크 유형이나 적격하지 않은 인스턴스를 선택하면 배포가 실패할 수 있습니다.  AWS 로컬 영역에서는 연결성이 부족하여 AWS S3에 대한 데이터 계층화를 사용할 수 없습니다.

link:https://aws.amazon.com/about-aws/global-infrastructure/localzones/features/?nc=sn&loc=2["AWS 설명서: 로컬 영역의 EC2 인스턴스 유형"^] .



== HA 쌍에서 스토리지가 작동하는 방식

ONTAP 클러스터와 달리 Cloud Volumes ONTAP HA 쌍의 스토리지는 노드 간에 공유되지 않습니다.  대신, 데이터는 노드 간에 동기적으로 미러링되므로 장애가 발생하더라도 데이터를 사용할 수 있습니다.



=== 저장 공간 할당

새 볼륨을 생성하고 추가 디스크가 필요한 경우 콘솔은 두 노드에 동일한 수의 디스크를 할당하고 미러링된 집계를 생성한 다음 새 볼륨을 생성합니다.  예를 들어, 볼륨에 디스크가 두 개 필요한 경우 콘솔은 노드당 디스크 두 개를 할당하여 총 4개의 디스크를 할당합니다.



=== 스토리지 구성

HA 쌍을 액티브-액티브 구성으로 사용할 수 있습니다. 이 경우 두 노드 모두 클라이언트에 데이터를 제공하고, 액티브-패시브 구성으로 사용할 경우 패시브 노드는 액티브 노드의 스토리지를 인수한 경우에만 데이터 요청에 응답합니다.


NOTE: 스토리지 시스템 뷰에서 콘솔을 사용할 때만 액티브-액티브 구성을 설정할 수 있습니다.



=== 성과 기대치

Cloud Volumes ONTAP HA 구성은 노드 간에 데이터를 동기적으로 복제하므로 네트워크 대역폭을 소모합니다.  결과적으로 단일 노드 Cloud Volumes ONTAP 구성과 비교했을 때 다음과 같은 성능을 기대할 수 있습니다.

* 단일 노드에서만 데이터를 제공하는 HA 구성의 경우, 읽기 성능은 단일 노드 구성의 읽기 성능과 비슷하지만 쓰기 성능은 낮습니다.
* 두 노드 모두에서 데이터를 제공하는 HA 구성의 경우, 읽기 성능은 단일 노드 구성의 읽기 성능보다 높고, 쓰기 성능은 동일하거나 더 높습니다.


Cloud Volumes ONTAP 성능에 대한 자세한 내용은 다음을 참조하세요.link:concept-performance.html["성능"] .



=== 저장소에 대한 클라이언트 액세스

클라이언트는 볼륨이 있는 노드의 데이터 IP 주소를 사용하여 NFS 및 CIFS 볼륨에 액세스해야 합니다.  NAS 클라이언트가 파트너 노드의 IP 주소를 사용하여 볼륨에 액세스하는 경우 트래픽이 두 노드 사이를 이동하게 되어 성능이 저하됩니다.


TIP: HA 쌍의 노드 간에 볼륨을 이동하는 경우 다른 노드의 IP 주소를 사용하여 볼륨을 다시 마운트해야 합니다.  그렇지 않으면 성능이 저하될 수 있습니다.  클라이언트가 CIFS에 대한 NFSv4 참조 또는 폴더 리디렉션을 지원하는 경우 Cloud Volumes ONTAP 시스템에서 해당 기능을 활성화하여 볼륨을 다시 마운트하지 않아도 됩니다.  자세한 내용은 ONTAP 문서를 참조하세요.

볼륨 관리 패널의 _마운트 명령_ 옵션을 통해 올바른 IP 주소를 쉽게 식별할 수 있습니다.

image::screenshot_mount_option.png[400]
