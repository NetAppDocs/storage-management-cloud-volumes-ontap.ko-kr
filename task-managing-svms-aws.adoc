---
sidebar: sidebar 
permalink: task-managing-svms-aws.html 
keywords: storage virtual machine, vserver, svm, storage vm, supported number, number supported 
summary: 스토리지 VM은 ONTAP 내에서 실행되는 가상 머신으로, 클라이언트에게 스토리지 및 데이터 서비스를 제공합니다.  이것을 SVM이나 vserver라고 알고 있을 수도 있습니다.  Cloud Volumes ONTAP 은 기본적으로 하나의 스토리지 VM으로 구성되지만 일부 구성에서는 추가 스토리지 VM을 지원합니다. 
---
= AWS에서 Cloud Volumes ONTAP 위한 데이터 제공 스토리지 VM 관리
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
스토리지 VM은 ONTAP 내에서 실행되는 가상 머신으로, 클라이언트에게 스토리지 및 데이터 서비스를 제공합니다.  이것을 _SVM_ 또는 _vserver_라고 알고 있을 수도 있습니다.  Cloud Volumes ONTAP 은 기본적으로 하나의 스토리지 VM으로 구성되지만 일부 구성에서는 추가 스토리지 VM을 지원합니다.

추가 데이터 제공 스토리지 VM을 생성하려면 AWS에서 IP 주소를 할당한 다음 Cloud Volumes ONTAP 구성에 따라 ONTAP 명령을 실행해야 합니다.



== 지원되는 스토리지 VM 수

9.7 릴리스부터 특정 Cloud Volumes ONTAP 구성에서 여러 스토리지 VM이 지원됩니다.  로 가다 https://docs.netapp.com/us-en/cloud-volumes-ontap-relnotes/index.html["Cloud Volumes ONTAP 릴리스 노트"^] Cloud Volumes ONTAP 버전에 지원되는 스토리지 VM 수를 확인하세요.

다른 모든 Cloud Volumes ONTAP 구성은 재해 복구에 사용되는 하나의 데이터 제공 스토리지 VM과 하나의 대상 스토리지 VM을 지원합니다.  소스 스토리지 VM에 장애가 발생하는 경우 데이터 액세스를 위해 대상 스토리지 VM을 활성화할 수 있습니다.



== 구성에 대한 제한 사항을 확인하세요

각 EC2 인스턴스는 네트워크 인터페이스당 최대 개수의 개인 IPv4 주소를 지원합니다.  AWS에서 새로운 스토리지 VM에 IP 주소를 할당하기 전에 제한을 확인해야 합니다.

.단계
. 가다 https://docs.netapp.com/us-en/cloud-volumes-ontap-relnotes/reference-limits-aws.html["Cloud Volumes ONTAP 릴리스 노트의 스토리지 한도 섹션"^] .
. 인스턴스 유형에 대한 인터페이스당 최대 IP 주소 수를 식별합니다.
. 다음 섹션에서 AWS에서 IP 주소를 할당할 때 필요하므로 이 번호를 기록해 두세요.




== AWS에서 IP 주소 할당

새 스토리지 VM에 대한 LIF를 생성하기 전에 AWS의 포트 e0a에 개인 IPv4 주소를 할당해야 합니다.

스토리지 VM에 대한 선택적 관리 LIF에는 단일 노드 시스템과 단일 AZ의 HA 쌍에 개인 IP 주소가 필요합니다.  이 관리 LIF는 SnapCenter 와 같은 관리 도구에 대한 연결을 제공합니다.

.단계
. AWS에 로그인하고 EC2 서비스를 엽니다.
. Cloud Volumes ONTAP 인스턴스를 선택하고 *네트워킹*을 클릭합니다.
+
HA 쌍에 스토리지 VM을 생성하는 경우 노드 1을 선택합니다.

. *네트워크 인터페이스*로 스크롤하여 포트 e0a의 *인터페이스 ID*를 클릭합니다.
+
image:screenshot_aws_e0a.gif["네트워크 인터페이스의 포트 e0a를 보여주는 AWS 콘솔의 스크린샷입니다."]

. 네트워크 인터페이스를 선택하고 *작업 > IP 주소 관리*를 클릭합니다.
. e0a의 IP 주소 목록을 확장합니다.
. IP 주소를 확인하세요:
+
.. 할당된 IP 주소의 수를 세어 포트에 추가 IP를 위한 공간이 있는지 확인하세요.
+
이 페이지의 이전 섹션에서 인터페이스당 지원되는 IP 주소의 최대 개수를 확인했어야 합니다.

.. 선택 사항: Cloud Volumes ONTAP 의 ONTAP CLI로 이동하여 *network interface show*를 실행하여 각 IP 주소가 사용 중인지 확인합니다.
+
IP 주소가 사용되지 않으면 새 스토리지 VM에서 해당 IP 주소를 사용할 수 있습니다.



. AWS 콘솔로 돌아와서 *새 IP 주소 할당*을 클릭하여 새 스토리지 VM에 필요한 양에 따라 추가 IP 주소를 할당합니다.
+
** 단일 노드 시스템: 사용되지 않는 보조 개인 IP가 하나 필요합니다.
+
스토리지 VM에 관리 LIF를 생성하려면 선택적 보조 개인 IP가 필요합니다.

** 단일 AZ의 HA 쌍: 노드 1에 사용되지 않는 보조 개인 IP가 하나 필요합니다.
+
스토리지 VM에 관리 LIF를 생성하려면 선택적 보조 개인 IP가 필요합니다.

** 여러 AZ의 HA 쌍: 각 노드에 사용되지 않는 보조 개인 IP가 하나씩 필요합니다.


. 단일 AZ의 HA 쌍에 IP 주소를 할당하는 경우 *보조 개인 IPv4 주소 재할당 허용*을 활성화합니다.
. *저장*을 클릭하세요.
. 여러 AZ에 HA 쌍이 있는 경우 노드 2에 대해 이 단계를 반복해야 합니다.




== 단일 노드 시스템에 스토리지 VM 생성

이 단계에서는 단일 노드 시스템에 새로운 스토리지 VM을 만듭니다.  NAS LIF를 생성하려면 개인 IP 주소 하나가 필요하고, 관리 LIF를 생성하려면 선택적으로 개인 IP 주소가 하나 더 필요합니다.

.단계
. 스토리지 VM과 스토리지 VM으로의 경로를 만듭니다.
+
[source, cli]
----
vserver create -rootvolume-security-style unix -rootvolume root_svm_2 -snapshot-policy default -vserver svm_2 -aggregate aggr1
----
+
[source, cli]
----
network route create -destination 0.0.0.0/0 -vserver svm_2 -gateway subnet_gateway
----
. NAS LIF를 생성합니다.
+
[source, cli]
----
network interface create -auto-revert true -vserver svm_2 -service-policy default-data-files -home-port e0a -address private_ip_x -netmask node1Mask -lif ip_nas_2 -home-node cvo-node
----
+
여기서 _private_ip_x_는 e0a의 사용되지 않는 보조 개인 IP입니다.

. 선택 사항: 스토리지 VM 관리 LIF를 만듭니다.
+
[source, cli]
----
network interface create -auto-revert true -vserver svm_2 -service-policy default-management -home-port e0a -address private_ip_y -netmask node1Mask -lif ip_svm_mgmt_2 -home-node cvo-node
----
+
여기서 _private_ip_y_는 e0a의 사용되지 않는 또 다른 보조 개인 IP입니다.

. 스토리지 VM에 하나 이상의 집계를 할당합니다.
+
[source, cli]
----
vserver add-aggregates -vserver svm_2 -aggregates aggr1,aggr2
----
+
이 단계는 새 스토리지 VM이 볼륨을 생성하기 전에 최소한 하나의 집계에 액세스해야 하기 때문에 필요합니다.





== 단일 AZ의 HA 쌍에 스토리지 VM 생성

이 단계에서는 단일 AZ의 HA 쌍에 새로운 스토리지 VM을 만듭니다.  NAS LIF를 생성하려면 개인 IP 주소 하나가 필요하고, 관리 LIF를 생성하려면 선택적으로 개인 IP 주소가 하나 더 필요합니다.

두 LIF는 모두 노드 1에 할당됩니다.  장애가 발생하면 개인 IP 주소가 노드 간에 이동할 수 있습니다.

.단계
. 스토리지 VM과 스토리지 VM으로의 경로를 만듭니다.
+
[source, cli]
----
vserver create -rootvolume-security-style unix -rootvolume root_svm_2 -snapshot-policy default -vserver svm_2 -aggregate aggr1
----
+
[source, cli]
----
network route create -destination 0.0.0.0/0 -vserver svm_2 -gateway subnet_gateway
----
. 노드 1에 NAS LIF를 생성합니다.
+
[source, cli]
----
network interface create -auto-revert true -vserver svm_2 -service-policy default-data-files -home-port e0a -address private_ip_x -netmask node1Mask -lif ip_nas_2 -home-node cvo-node1
----
+
여기서 _private_ip_x_는 cvo-node1의 e0a에 있는 사용되지 않는 보조 개인 IP입니다.  서비스 정책 default-data-files는 IP가 파트너 노드로 마이그레이션될 수 있음을 나타내므로 인수 시 이 IP 주소는 cvo-node2의 e0a로 이전될 수 있습니다.

. 선택 사항: 노드 1에 스토리지 VM 관리 LIF를 만듭니다.
+
[source, cli]
----
network interface create -auto-revert true -vserver svm_2 -service-policy default-management -home-port e0a -address private_ip_y -netmask node1Mask -lif ip_svm_mgmt_2 -home-node cvo-node1
----
+
여기서 _private_ip_y_는 e0a의 사용되지 않는 또 다른 보조 개인 IP입니다.

. 스토리지 VM에 하나 이상의 집계를 할당합니다.
+
[source, cli]
----
vserver add-aggregates -vserver svm_2 -aggregates aggr1,aggr2
----
+
이 단계는 새 스토리지 VM이 볼륨을 생성하기 전에 최소한 하나의 집계에 액세스해야 하기 때문에 필요합니다.

. Cloud Volumes ONTAP 9.11.1 이상을 실행하는 경우 스토리지 VM에 대한 네트워크 서비스 정책을 수정하세요.
+
Cloud Volumes ONTAP 아웃바운드 관리 연결에 iSCSI LIF를 사용할 수 있도록 하려면 서비스를 수정해야 합니다.

+
[source, cli]
----
network interface service-policy remove-service -vserver <svm-name> -policy default-data-files -service data-fpolicy-client
network interface service-policy remove-service -vserver <svm-name> -policy default-data-files -service management-ad-client
network interface service-policy remove-service -vserver <svm-name> -policy default-data-files -service management-dns-client
network interface service-policy remove-service -vserver <svm-name> -policy default-data-files -service management-ldap-client
network interface service-policy remove-service -vserver <svm-name> -policy default-data-files -service management-nis-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-blocks -service data-fpolicy-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-blocks -service management-ad-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-blocks -service management-dns-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-blocks -service management-ldap-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-blocks -service management-nis-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-iscsi -service data-fpolicy-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-iscsi -service management-ad-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-iscsi -service management-dns-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-iscsi -service management-ldap-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-iscsi -service management-nis-client
----




== 여러 AZ의 HA 쌍에 스토리지 VM 생성

이 단계에서는 여러 AZ의 HA 쌍에 새로운 스토리지 VM을 만듭니다.

NAS LIF에는 _유동_ IP 주소가 필요하지만 관리 LIF에는 선택 사항입니다.  이러한 유동 IP 주소를 사용하면 AWS에서 개인 IP를 할당할 필요가 없습니다.  대신, AWS 라우팅 테이블에서 플로팅 IP가 자동으로 구성되어 동일한 VPC에 있는 특정 노드의 ENI를 가리킵니다.

ONTAP 에서 플로팅 IP를 사용하려면 각 노드의 모든 스토리지 VM에 개인 IP 주소를 구성해야 합니다.  이는 노드 1과 노드 2에서 iSCSI LIF가 생성되는 아래 단계에 반영됩니다.

.단계
. 스토리지 VM과 스토리지 VM으로의 경로를 만듭니다.
+
[source, cli]
----
vserver create -rootvolume-security-style unix -rootvolume root_svm_2 -snapshot-policy default -vserver svm_2 -aggregate aggr1
----
+
[source, cli]
----
network route create -destination 0.0.0.0/0 -vserver svm_2 -gateway subnet_gateway
----
. 노드 1에 NAS LIF를 생성합니다.
+
[source, cli]
----
network interface create -auto-revert true -vserver svm_2 -service-policy default-data-files -home-port e0a -address floating_ip -netmask node1Mask -lif ip_nas_floating_2 -home-node cvo-node1
----
+
** HA 구성을 배포하는 AWS 지역의 모든 VPC에 대한 CIDR 블록 외부에 부동 IP 주소가 있어야 합니다.  192.168.209.27은 유동 IP 주소의 예입니다. link:reference-networking-aws.html#requirements-for-ha-pairs-in-multiple-azs["플로팅 IP 주소 선택에 대해 자세히 알아보세요"] .
** `-service-policy default-data-files`IP가 파트너 노드로 마이그레이션될 수 있음을 나타냅니다.


. 선택 사항: 노드 1에 스토리지 VM 관리 LIF를 만듭니다.
+
[source, cli]
----
network interface create -auto-revert true -vserver svm_2 -service-policy default-management -home-port e0a -address floating_ip -netmask node1Mask -lif ip_svm_mgmt_2 -home-node cvo-node1
----
. 노드 1에 iSCSI LIF를 생성합니다.
+
[source, cli]
----
network interface create -vserver svm_2 -service-policy default-data-blocks -home-port e0a -address private_ip -netmask nodei1Mask -lif ip_node1_iscsi_2 -home-node cvo-node1
----
+
** 이 iSCSI LIF는 스토리지 VM의 플로팅 IP의 LIF 마이그레이션을 지원하는 데 필요합니다.  iSCSI LIF일 필요는 없지만 노드 간 마이그레이션을 위해 구성할 수는 없습니다.
** `-service-policy default-data-block`IP 주소가 노드 간에 마이그레이션되지 않음을 나타냅니다.
** _private_ip_는 cvo_node1의 eth0(e0a)에 있는 사용되지 않는 보조 개인 IP 주소입니다.


. 노드 2에 iSCSI LIF를 생성합니다.
+
[source, cli]
----
network interface create -vserver svm_2 -service-policy default-data-blocks -home-port e0a -address private_ip -netmaskNode2Mask -lif ip_node2_iscsi_2 -home-node cvo-node2
----
+
** 이 iSCSI LIF는 스토리지 VM의 플로팅 IP의 LIF 마이그레이션을 지원하는 데 필요합니다.  iSCSI LIF일 필요는 없지만 노드 간 마이그레이션을 위해 구성할 수는 없습니다.
** `-service-policy default-data-block`IP 주소가 노드 간에 마이그레이션되지 않음을 나타냅니다.
** _private_ip_는 cvo_node2의 eth0(e0a)에 있는 사용되지 않는 보조 개인 IP 주소입니다.


. 스토리지 VM에 하나 이상의 집계를 할당합니다.
+
[source, cli]
----
vserver add-aggregates -vserver svm_2 -aggregates aggr1,aggr2
----
+
이 단계는 새 스토리지 VM이 볼륨을 생성하기 전에 최소한 하나의 집계에 액세스해야 하기 때문에 필요합니다.

. Cloud Volumes ONTAP 9.11.1 이상을 실행하는 경우 스토리지 VM에 대한 네트워크 서비스 정책을 수정하세요.
+
Cloud Volumes ONTAP 아웃바운드 관리 연결에 iSCSI LIF를 사용할 수 있도록 하려면 서비스를 수정해야 합니다.

+
[source, cli]
----
network interface service-policy remove-service -vserver <svm-name> -policy default-data-files -service data-fpolicy-client
network interface service-policy remove-service -vserver <svm-name> -policy default-data-files -service management-ad-client
network interface service-policy remove-service -vserver <svm-name> -policy default-data-files -service management-dns-client
network interface service-policy remove-service -vserver <svm-name> -policy default-data-files -service management-ldap-client
network interface service-policy remove-service -vserver <svm-name> -policy default-data-files -service management-nis-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-blocks -service data-fpolicy-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-blocks -service management-ad-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-blocks -service management-dns-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-blocks -service management-ldap-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-blocks -service management-nis-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-iscsi -service data-fpolicy-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-iscsi -service management-ad-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-iscsi -service management-dns-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-iscsi -service management-ldap-client
network interface service-policy add-service -vserver <svm-name> -policy default-data-iscsi -service management-nis-client
----

